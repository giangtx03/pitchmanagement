<?xml version = "1.0" encoding = "UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pitchmanagement.daos.PitchTimeDao">

    <insert id="insertPitchTime" parameterType="com.pitchmanagement.dtos.PitchTimeDto">
        INSERT INTO
            pitch_times(sub_pitch_id, time_slot_id, price)
        VALUES (#{subPitchId}, #{timeSlotId}, #{price})
    </insert>

    <select id="getPitchTimeBySubPitchId" parameterType="Long" resultType="com.pitchmanagement.dtos.PitchTimeDto">
        SELECT
            pt.price,
            ts.start_time AS startTime,
            ts.end_time AS endTime
        FROM pitch_times pt
        LEFT JOIN time_slots ts ON ts.id = pt.time_slot_id
        WHERE pt.sub_pitch_id = #{subPitchId}
    </select>

    <update id="updatePitchTime" parameterType="com.pitchmanagement.dtos.PitchTimeDto">
        UPDATE pitch_times SET
            price = #{price},
            time_slot_id = #{timeSlotId}
        WHERE sub_pitch_id = #{subPitchId}
    </update>

    <delete id="deletePitchTime" parameterType="com.pitchmanagement.dtos.PitchTimeDto">
        DELETE pitch_times
        WHERE time_slot_id = #{timeSlotId} AND sub_pitch_id = #{subPitchId}
    </delete>

</mapper>